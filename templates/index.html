<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script src = "https://code.jquery.com/jquery-3.6.0.min.js" defer></script>
  <title>Website Example</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f2f2f2;
      padding: 10px;
    }

    .top-bar div {
      margin-right: 10px;
    }

    .review-block {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #f2f2f2;
      padding: 10px;
      margin-bottom: 10px;
    }

    .review-block-details {
      flex-grow: 1;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <div id="a_write_review_div"><a href = "/write">Write a Review</a></div>
    <input type="text" id="a_search_bar_text_field" placeholder="Search">
    <input type = "button" value = "Search" onclick = "search_reviews()">
    <div id="a_bookmark_div" onclick = "fetch_bookmarked()">Bookmarked</div>
    <div id="a_recommend_div" onclick = "fetch_recommended()">Recommended</div>
    <div id="a_write_div" onclick = "fetch_written()">Written</div>
    <div id="logout_div"><a href = "/logout">Logout</a></div>
  </div>
  <div id="reviews-container"></div>
  <!-- Rest of the website content -->

  <script>
    function renderReviews(reviews) {
      var container = document.getElementById("reviews-container");

      for (var i = 0; i < reviews.length; i++) {
        var review = reviews[i];

        var reviewBlock = document.createElement("div");
        reviewBlock.className = "review-block";

        var reviewDetails = document.createElement("div");
        reviewDetails.className = "review-block-details";

        var restaurantName = document.createElement("h2");
        restaurantName.textContent = review["restaurant_name"];

        var foodName = document.createElement("p");
        foodName.textContent = "Food: " + review["food_name"];

        var foodPrice = document.createElement("p");
        foodPrice.textContent = "Price: " + review["food_price"];

        var serviceRating = document.createElement("p");
        serviceRating.textContent = "Service Rating: " + review["service_rating"];

        var foodRating = document.createElement("p");
        foodRating.textContent = "Food Rating: " + review["food_rating"];

        var recommendRating = document.createElement("p");
        recommendRating.textContent = "Recommend Rating: " + review["recommend_rating"];

        var authorName = document.createElement("p");
        authorName.textContent = "Author: " + review["author_name"];

        reviewDetails.appendChild(restaurantName);
        reviewDetails.appendChild(foodName);
        reviewDetails.appendChild(foodPrice);
        reviewDetails.appendChild(serviceRating);
        reviewDetails.appendChild(foodRating);
        reviewDetails.appendChild(recommendRating);
        reviewDetails.appendChild(authorName);

        reviewBlock.appendChild(reviewDetails);

        container.appendChild(reviewBlock);
      }
    }

    // Example usage
    var reviews = [
      {
        "restaurant_name": "A",
        "food_name": "B",
        "food_price": 99,
        "recommend_rating": 4,
        "upvotes": 40,
        "author_name": "C",
        "service_rating": 4,
        "food_rating": 3
      },
      {
        "restaurant_name": "C",
        "food_name": "D",
        "food_price": 180,
        "recommend_rating": 3,
        "upvotes": 30,
        "author_name": "G",
        "service_rating": 4,
        "food_rating": 3
      }
    ];

    renderReviews(reviews);
    renderReviews(reviews);
  </script>

  <script>
    function fetch_bookmarked() {
        $.ajax({
            "url" : "/bookmarked",
            "method" : "POST",
            "dataType" : "json",
            "success" : function(response) {
                console.log("SUCCESS"); 
                console.log(response);
                if (response["status"] == "retrieve-success") {
                    console.log(response["data"]);
                    document.getElementById("reviews-container").innerText = "";
                    renderReviews(response["data"]);
                }
            }
        })
    }
    function fetch_recommended() {
        $.ajax({
            "url" : "/recommended",
            "method" : "POST",
            "dataType" : "json",
            "success" : function(response) {
                console.log("SUCCESS"); 
                console.log(response);
                if (response["status"] == "retrieve-success") {
                    console.log(response["data"]);
                    document.getElementById("reviews-container").innerText = "";
                    renderReviews(response["data"]);
                }
            }
        })
    }
    function fetch_written() {
        $.ajax({
            "url" : "/written",
            "method" : "POST",
            "dataType" : "json",
            "success" : function(response) {
                console.log("SUCCESS"); 
                console.log(response);
                if (response["status"] == "retrieve-success") {
                    console.log(response["data"]);
                    document.getElementById("reviews-container").innerText = "";
                    renderReviews(response["data"]);
                }
            }
        })
    }
    function search_reviews() {
        let searchString = document.getElementById("a_search_bar_text_field").value;
        $.ajax({
            "url" : "/search",
            "method" : "POST",
            "contentType" : "application/json",
            "dataType" : "json",
            "data" : JSON.stringify({ "search-string" : searchString }),
            "success" : function(response) {
                console.log("SUCCESS"); 
                console.log(response);
                if (response["status"] == "retrieve-success") {
                    console.log(response["data"]);
                    document.getElementById("reviews-container").innerText = "";
                    renderReviews(response["data"]);
                }
            }
        })
    }
  </script>
</body>
</html>
